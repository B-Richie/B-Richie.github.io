<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> 
    <link rel="shortcut icon" href="#">
      <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-147193911-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-147193911-1');
</script>
  </head>
	<style>
		pre {
			font-family: monospace;
			background: #f4f4f4;
			border: 1px solid #ddd;
			border-left: 3px solid #0000FF;
		    }
	</style>
<body>
<div class="container">
  <h1>Dapper Data Access Layer for ASP Core 2.2</h1>
<p>Multi-provider ICO data access layer using Dapper</p>
  <h2>How it Works</h2>
  </br>
  <div class="form-group">
    <h5>BaseService.cs</h5>
    <p>Abstract class implementing Dapper database commands.
      An abstract IDbConnection property is passed in containing the provider and connection string to your database of choice.
      You will have the ability to use multiple providers or multiple connection strings from the same provider for a single request!
      Inherit this class within your cleint's service layer.
    </p>
    <h5>ConnectionStringConfiguration.cs</h5>
    <p>Static middleware component for setting the connection strings for each provider.
      The IOptions interface is used to map the appsettings.json database connection section from the client:
    </p>
    <pre>
	  <code>
	      services.AddTransient(resolver =>
	      {
		      var databaseConnections = resolver.GetService<IOptions<DatabaseConnections>>().Value;
		      var iDbConnections = resolver.GetServices<IDbConnection>();

		      databaseConnections.OracleConnections.ToList().ForEach(ora =>
		    {
		      ora.dbConnection = iDbConnections.Where(w => w.GetType() == typeof(OracleConnection)).FirstOrDefault();
		      ora.dbConnection.ConnectionString = ora.ConnectionString;
		      ora.Guid = Guid.NewGuid();
		    });
		      databaseConnections.MSSqlConnections.ToList().ForEach(sql =>
		    {
		      sql.dbConnection = iDbConnections.Where(w => w.GetType() == typeof(SqlConnection)).FirstOrDefault();
		      sql.dbConnection.ConnectionString = sql.ConnectionString;
		      sql.Guid = Guid.NewGuid();
		    });
	    }
	</code>
  </pre>
  </div>
  <div class="form-group">
	  </br>
	  <h1>ASP Core 2.2 Web Application Using Dapper</h1>
	  </br>
	  <h2>How to Add to a Client</h2>
	</br>
	<h5>appSettings.json</h5>
	<p>Add your providers and connection strings as follows:</p>
	<pre>
	<code>
		"DatabaseConnections": {
			    "OracleConnections": [
			      {
				"Alias": "Optional",        
				"ConnectionString": "Required"
			      },
			      {
				"Alias": "Optional",        
				"ConnectionString": "Required"
			      }
			    ],
			    "MSSqlConnections": [
			      {
				"Alias": "Optional",        
				"ConnectionString": "Required"
			      }
			    ]
		     }
	</code>
	</pre>
	<p>
		Reference the Dapper_DAL data access layer project in your client:
	</p>
	<img src="Images/DAL_Reference.PNG alt="DAL Reference" width="200px" height="80px">
	  
  </div>
  <div class="form-group">
    <a href="https://github.com/B-Richie/Dapper_DAL">Dapper DAL Source Code</a>    
  </div>
  <div class="form-group">
    <a href="https://github.com/B-Richie/Core_Dapper">Dapper Client Example</a>
  </div>
</div>
</body>
</html>
